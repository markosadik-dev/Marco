<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#f4f2ef" />
  <title>Marco & Martha â€” Invitation</title>

  <style>
    :root{
      --card:#ffffffcc;
      --ink:#1f1f1f;
      --muted:#6b6b6b;
      --accent:#c7b08b;
      --stroke:#e7e2da;
      --radius:24px;
      --shadow: 0 18px 55px rgba(0,0,0,.10);
      --shadow2: 0 10px 25px rgba(0,0,0,.08);
    }

    *{box-sizing:border-box}
    html,body{height:100%}

    /* ===== Background image + blur ===== */
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--ink);
      overflow:hidden;
      background:#f4f2ef;
      position:relative;
    }
    body::before{
      content:"";
      position:fixed; inset:0;
      background-image:url('https://i.postimg.cc/DZthvxcZ/92f685f7-1de6-4c9d-acd6-42ce4990e943.jpg');
      background-size:cover;
      background-position:center;
      filter: blur(18px);
      transform: scale(1.15);
      opacity:.30;
      z-index:-2;
    }
    body::after{
      content:"";
      position:fixed; inset:0;
      background: radial-gradient(900px 600px at 20% 0%, rgba(255,255,255,.85), transparent 55%),
                  radial-gradient(900px 600px at 80% 20%, rgba(255,255,255,.80), transparent 55%),
                  linear-gradient(180deg, rgba(246,244,241,.90), rgba(239,234,227,.92));
      z-index:-1;
    }

    .wrap{
      height:100%;
      padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom);
      display:flex;
      flex-direction:column;
    }

    /* Top bar */
    .topbar{
      padding:14px 18px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .brand{display:flex; align-items:center; gap:10px; letter-spacing:.5px;}
    .seal{
      width:34px;height:34px;border-radius:999px;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg,#fff, #f7f2ea);
      display:grid; place-items:center;
      box-shadow: var(--shadow2);
      font-weight:700;
      color:var(--accent);
      font-family: "Georgia", serif;
    }
    .pill{
      border:1px solid var(--stroke);
      background:#ffffffa8;
      padding:8px 12px;
      border-radius:999px;
      font-size:12px;
      color:var(--muted);
      box-shadow: 0 8px 18px rgba(0,0,0,.05);
      backdrop-filter: blur(10px);
    }

    /* Slider */
    .slider{flex:1; position:relative; overflow:hidden;}
    .track{
      height:100%;
      display:flex;
      transition: transform .45s cubic-bezier(.2,.8,.2,1);
      will-change: transform;
      touch-action: pan-y;
    }
    .page{
      min-width:100%;
      height:100%;
      padding: 8px 18px 18px;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .card{
      width:min(540px, 94vw);
      height:min(780px, 78vh);
      background: var(--card);
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      overflow:hidden;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute; inset:-80px -120px auto auto;
      width:260px;height:260px;border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #fff, rgba(199,176,139,.15) 40%, transparent 70%);
      transform: rotate(15deg);
      pointer-events:none;
    }

    .content{
      height:100%;
      padding:22px 22px 20px;
      display:flex;
      flex-direction:column;
      gap:16px;
    }

    h1,h2,h3,p{margin:0}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;}

    /* Cover image (sharp) with glass/blur overlay */
    .cover-image{
      width:100%;
      height:240px;
      border-radius:18px;
      background-image: url('https://i.postimg.cc/DZthvxcZ/92f685f7-1de6-4c9d-acd6-42ce4990e943.jpg');
      background-size: cover;
      background-position: center;
      position:relative;
      overflow:hidden;
      border:1px solid var(--stroke);
      box-shadow: 0 10px 22px rgba(0,0,0,.06);
    }
    .cover-image::after{
      content:"";
      position:absolute; inset:0;
      background: rgba(255,255,255,.20);
      backdrop-filter: blur(6px);
    }

    .title{
      text-align:center;
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .subtitle{
      color:var(--muted);
      font-size:13px;
      letter-spacing:.6px;
      text-transform: uppercase;
    }
    .names{
      font-family:"Georgia", "Times New Roman", serif;
      font-weight:700;
      font-size:40px;
      line-height:1.05;
      letter-spacing:.3px;
    }
    .amp{
      font-family:"Georgia", serif;
      color:var(--accent);
      font-size:20px;
      margin:2px 0 0;
    }
    .divider{
      width:120px;
      height:1px;
      background: linear-gradient(90deg, transparent, var(--stroke), transparent);
      margin: 8px auto 0;
    }
    .bigSeal{
      width:82px;height:82px;border-radius:999px;
      border:1px solid var(--stroke);
      background: linear-gradient(180deg,#fff, #f7f2ea);
      display:grid; place-items:center;
      box-shadow: var(--shadow2);
      margin: 6px auto 0;
      position:relative;
    }
    .bigSeal span{
      font-family:"Georgia", serif;
      font-weight:700;
      color:var(--accent);
      font-size:20px;
    }
    .bigSeal::after{
      content:"";
      position:absolute; inset:10px;
      border-radius:999px;
      border:1px dashed rgba(199,176,139,.55);
    }

    .quote{
      text-align:center;
      color:var(--muted);
      font-size:14px;
      line-height:1.7;
      padding: 0 8px;
    }

    .btnRow{
      margin-top:auto;
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
    }
    .btn{
      cursor:pointer;
      border:1px solid var(--stroke);
      background:#fff;
      padding:12px 14px;
      border-radius:14px;
      font-size:13px;
      box-shadow: 0 10px 20px rgba(0,0,0,.06);
      transition: transform .12s ease, box-shadow .12s ease;
      color:var(--ink);
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:10px;
      min-width: 170px;
      justify-content:center;
      user-select:none;
    }
    .btn:active{transform: translateY(1px); box-shadow: 0 8px 14px rgba(0,0,0,.06);}
    .btn.primary{
      background: linear-gradient(180deg,#ffffff, #fbf7f1);
      border-color: rgba(199,176,139,.6);
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap:12px;
      margin-top:10px;
    }
    .tile{
      border:1px solid var(--stroke);
      background:#ffffffb0;
      border-radius:18px;
      padding:14px;
      box-shadow: 0 10px 20px rgba(0,0,0,.05);
      min-height:92px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap:6px;
      text-align:center;
    }
    .tile .k{font-size:11px; color:var(--muted); letter-spacing:.6px; text-transform: uppercase}
    .tile .v{font-size:18px; font-weight:700}
    .tile .s{font-size:12px; color:var(--muted)}

    .list{
      margin-top:6px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .row{
      display:flex;
      gap:12px;
      align-items:flex-start;
      border:1px solid var(--stroke);
      background:#ffffffb0;
      border-radius:18px;
      padding:12px 14px;
      box-shadow: 0 10px 20px rgba(0,0,0,.05);
    }
    .time{
      min-width:84px;
      font-weight:700;
      color:var(--accent);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;
      font-size:13px;
      text-align:left;
      direction:ltr;
    }
    .desc{
      flex:1;
      display:flex;
      flex-direction:column;
      gap:2px;
    }
    .desc b{font-size:14px}
    .desc span{font-size:12px;color:var(--muted);line-height:1.6}

    .mapgrid{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
      margin-top:8px;
    }
    .mapCard{
      border:1px solid var(--stroke);
      border-radius:18px;
      overflow:hidden;
      background:#fff;
      box-shadow: 0 10px 20px rgba(0,0,0,.05);
    }
    .mapHead{
      padding:10px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background: #fff;
      border-bottom:1px solid var(--stroke);
    }
    .mapHead b{font-size:13px}
    .mapHead span{font-size:12px; color:var(--muted)}
    .mapActions{display:flex; gap:8px; flex-wrap:wrap;}
    .miniBtn{
      border:1px solid var(--stroke);
      background:#ffffff;
      border-radius:12px;
      padding:8px 10px;
      font-size:12px;
      text-decoration:none;
      color:var(--ink);
      box-shadow: 0 8px 16px rgba(0,0,0,.05);
      white-space:nowrap;
    }
    iframe{border:0; width:100%; height:190px}

    .nav{
      padding: 12px 18px 18px;
      display:flex;
      justify-content:center;
      align-items:center;
      gap:10px;
    }
    .dot{
      width:9px;height:9px;border-radius:999px;
      background: rgba(0,0,0,.18);
      transition: all .2s ease;
    }
    .dot.active{
      width:22px;
      background: rgba(199,176,139,.9);
    }

    .hint{
      position:absolute;
      left:50%;
      transform:translateX(-50%);
      bottom:70px;
      font-size:12px;
      color:var(--muted);
      background:#ffffffb8;
      border:1px solid var(--stroke);
      padding:8px 12px;
      border-radius:999px;
      box-shadow: 0 10px 20px rgba(0,0,0,.05);
      backdrop-filter: blur(10px);
      pointer-events:none;
      opacity:0;
      animation: pop 2.4s ease 1.1s 1 forwards;
    }
    @keyframes pop{
      0%{opacity:0; transform:translateX(-50%) translateY(10px)}
      20%{opacity:1; transform:translateX(-50%) translateY(0)}
      80%{opacity:1}
      100%{opacity:0}
    }

    /* Floating music button */
    .music-fab{
      position:fixed;
      right:14px;
      bottom:14px;
      z-index:50;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .music-btn{
      border:1px solid var(--stroke);
      background:#ffffffd8;
      backdrop-filter: blur(10px);
      padding:12px 14px;
      border-radius:999px;
      box-shadow: 0 12px 26px rgba(0,0,0,.10);
      cursor:pointer;
      font-size:13px;
      color:var(--ink);
      display:flex;
      align-items:center;
      gap:10px;
      user-select:none;
    }
    .music-dot{
      width:9px;height:9px;border-radius:99px;
      background: rgba(0,0,0,.25);
    }
    .music-dot.on{ background: rgba(199,176,139,.95); }

    @media (max-width:420px){
      .names{font-size:34px}
      .card{height:min(760px, 80vh)}
      .btn{min-width: 160px}
      .cover-image{height:220px}
    }
  </style>
</head>

<body>

<!-- ===== Music (IMPORTANT: replace MUSIC_URL with your mp3 link) ===== -->
<audio id="bgm" loop preload="auto" crossorigin="anonymous">
  <!-- Example placeholder: put your MP3 direct link here -->
  <source id="bgmSrc" src="" type="audio/mpeg">
</audio>

<div class="music-fab">
  <div class="music-btn" id="musicToggle" title="Play / Pause Music">
    <span class="music-dot" id="musicLed"></span>
    <span id="musicText">Play Music</span>
  </div>
</div>

<div class="wrap">
  <div class="topbar">
    <div class="brand">
      <div class="seal" id="miniSeal">M</div>
      <div class="pill" id="guestPill">Private Invitation</div>
    </div>
    <div class="pill mono" id="todayPill">â€”</div>
  </div>

  <div class="slider" id="slider">
    <div class="track" id="track">

      <!-- PAGE 1: COVER -->
      <section class="page">
        <div class="card">
          <div class="content">
            <div class="cover-image"></div>

            <div class="title">
              <div class="subtitle" id="tagline">You are invited</div>
              <div class="names" id="names1">Marco</div>
              <div class="amp">&</div>
              <div class="names" id="names2">Martha</div>
              <div class="divider"></div>
              <div class="bigSeal"><span id="sealInitials">Mâ™¥M</span></div>
            </div>

            <p class="quote" id="coverLine">
              Together with their families, Marco and Martha invite you to celebrate their wedding.
            </p>

            <div class="btnRow">
              <button class="btn primary" id="btnNext1">Begin / Swipe</button>
              <a class="btn" id="btnAddCalendar" href="#" target="_blank" rel="noopener">Add to Calendar</a>
            </div>
          </div>
        </div>
      </section>

      <!-- PAGE 2: DETAILS -->
      <section class="page">
        <div class="card">
          <div class="content">
            <div class="title">
              <div class="subtitle">Details</div>
              <h2 style="text-align:center; font-family: Georgia, serif; font-size:26px;">The Wedding Day</h2>
              <div class="divider"></div>
            </div>

            <p class="quote">
              A formal celebration, and your presence would mean the world to us.
            </p>

            <div class="grid">
              <div class="tile">
                <div class="k">Date</div>
                <div class="v" id="dateText">â€”</div>
                <div class="s" id="dayText">â€”</div>
              </div>

              <div class="tile">
                <div class="k">Ceremony</div>
                <div class="v">5:00 PM</div>
                <div class="s">Church</div>
              </div>

              <div class="tile">
                <div class="k">Reception</div>
                <div class="v">6:30 PM</div>
                <div class="s">La Novia (Villa)</div>
              </div>

              <div class="tile">
                <div class="k">Dress Code</div>
                <div class="v">Formal</div>
                <div class="s">Kindly dress accordingly</div>
              </div>

              <div class="tile">
                <div class="k">Parking</div>
                <div class="v">Free Parking</div>
                <div class="s">Available at the venue</div>
              </div>
            </div>

            <div class="btnRow">
              <button class="btn" id="btnPrev2">Back</button>
              <button class="btn primary" id="btnNext2">Next</button>
            </div>
          </div>
        </div>
      </section>

      <!-- PAGE 3: COUNTDOWN -->
      <section class="page">
        <div class="card">
          <div class="content">
            <div class="title">
              <div class="subtitle">Countdown</div>
              <h2 style="text-align:center; font-family: Georgia, serif; font-size:26px;">Until We Celebrate</h2>
              <div class="divider"></div>
            </div>

            <div class="grid" style="margin-top:14px">
              <div class="tile"><div class="k">Days</div><div class="v" id="dd">â€”</div><div class="s">Days</div></div>
              <div class="tile"><div class="k">Hours</div><div class="v" id="hh">â€”</div><div class="s">Hours</div></div>
              <div class="tile"><div class="k">Minutes</div><div class="v" id="mm">â€”</div><div class="s">Minutes</div></div>
              <div class="tile"><div class="k">Seconds</div><div class="v" id="ss">â€”</div><div class="s">Seconds</div></div>
            </div>

            <p class="quote" style="margin-top:12px">
              We cannot wait to celebrate with you.
            </p>

            <div class="btnRow">
              <button class="btn" id="btnPrev3">Back</button>
              <button class="btn primary" id="btnNext3">Next</button>
            </div>
          </div>
        </div>
      </section>

      <!-- PAGE 4: PROGRAM -->
      <section class="page">
        <div class="card">
          <div class="content">
            <div class="title">
              <div class="subtitle">Schedule</div>
              <h2 style="text-align:center; font-family: Georgia, serif; font-size:26px;">Order of Events</h2>
              <div class="divider"></div>
            </div>

            <div class="list" id="timeline"></div>

            <div class="btnRow">
              <button class="btn" id="btnPrev4">Back</button>
              <button class="btn primary" id="btnNext4">Next</button>
            </div>
          </div>
        </div>
      </section>

      <!-- PAGE 5: LOCATIONS -->
      <section class="page">
        <div class="card">
          <div class="content">
            <div class="title">
              <div class="subtitle">Locations</div>
              <h2 style="text-align:center; font-family: Georgia, serif; font-size:26px;">Ceremony & Reception</h2>
              <div class="divider"></div>
            </div>

            <div class="mapgrid">
              <div class="mapCard">
                <div class="mapHead">
                  <div>
                    <b>St. Anthony the Great Church â€” Zahraa El Maadi</b><br/>
                    <span>5:00 PM â€” Ceremony</span>
                  </div>
                  <div class="mapActions">
                    <a class="miniBtn" href="https://maps.app.goo.gl/3tpzk1J72SNa438aA" target="_blank" rel="noopener">Open in Google Maps</a>
                  </div>
                </div>
                <iframe loading="lazy" referrerpolicy="no-referrer-when-downgrade"
                  src="https://www.google.com/maps?q=St.%20Anthony%20the%20Great%20Church%20Zahraa%20El%20Maadi&output=embed"></iframe>
              </div>

              <div class="mapCard">
                <div class="mapHead">
                  <div>
                    <b>La Novia wedding venue</b><br/>
                    <span>6:30 PM â€” Reception</span>
                  </div>
                  <div class="mapActions">
                    <a class="miniBtn" href="https://maps.app.goo.gl/HqVEuU17rrmYpFe8A" target="_blank" rel="noopener">Open in Google Maps</a>
                  </div>
                </div>
                <iframe loading="lazy" referrerpolicy="no-referrer-when-downgrade"
                  src="https://www.google.com/maps?q=La%20Novia%20wedding%20venue&output=embed"></iframe>
              </div>
            </div>

            <p class="quote" style="margin-top:10px">
              Formal attire is kindly requested.<br/>
              <b>Free parking is available at the venue.</b>
            </p>

            <div class="btnRow">
              <button class="btn" id="btnPrev5">Back</button>
              <button class="btn primary" id="btnFinish">Done âœ…</button>
            </div>
          </div>
        </div>
      </section>

    </div>

    <div class="hint">Swipe left / right ðŸ‘ˆðŸ‘‰</div>
  </div>

  <div class="nav" id="dots"></div>
</div>

<script>
/* =========================
   EDIT THESE ONLY
========================= */
const MUSIC_URL = ""; 
// Ø­Ø· Ù‡Ù†Ø§ Ù„ÙŠÙ†Ùƒ MP3 Ù…Ø¨Ø§Ø´Ø± (ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ù€ .mp3). Ù…Ø«Ø§Ù„:
// const MUSIC_URL = "https://yourdomain.com/song.mp3";

const INV = {
  couple: { name1: "Marco", name2: "Martha", initials: "Mâ™¥M" },
  event: {
    // Countdown to ceremony time (Cairo)
    dateTimeISO: "2026-01-24T17:00:00+02:00",
    dateLocale: "en-GB"
  },
  timeline: [
    { time: "5:00 PM",  title: "Ceremony",          note: "Church service" },
    { time: "6:30 PM",  title: "Reception Arrival", note: "Villa â€” La Novia" },
    { time: "6:45 PM",  title: "Welcome Drinks",    note: "Guests reception" },
    { time: "7:15 PM",  title: "Grand Entrance",    note: "Zaffa" },
    { time: "7:30 PM",  title: "Dancing",           note: "Let the party begin" },
    { time: "8:15 PM",  title: "Champagne Moment",  note: "A toast to the night" },
    { time: "8:45 PM",  title: "Dinner Buffet",     note: "Buffet opens" },
    { time: "10:00 PM", title: "Surprise Dance",    note: "A special performance" },
    { time: "10:30 PM", title: "Memories & Photos", note: "Lots of photos together" }
  ],
  guestPersonalization: true // use ?g=Ahmed
};

/* =========================
   Helpers / App
========================= */
const $ = (id)=>document.getElementById(id);
function pad(n){ return String(n).padStart(2,"0"); }

function formatDateParts(iso){
  const d = new Date(iso);
  const dayName = d.toLocaleDateString(INV.event.dateLocale,{weekday:"long"});
  const dateStr = d.toLocaleDateString(INV.event.dateLocale,{year:"numeric", month:"long", day:"numeric"});
  return { dayName, dateStr };
}

function buildCalendarLink(){
  const start = new Date(INV.event.dateTimeISO);
  const end = new Date(start.getTime() + 2*60*60*1000);
  const fmt = (dt)=>{
    const z = new Date(dt.getTime());
    return `${z.getUTCFullYear()}${pad(z.getUTCMonth()+1)}${pad(z.getUTCDate())}T${pad(z.getUTCHours())}${pad(z.getUTCMinutes())}${pad(z.getUTCSeconds())}Z`;
  };
  const text = encodeURIComponent(`${INV.couple.name1} & ${INV.couple.name2} Wedding`);
  const details = encodeURIComponent(`Wedding of ${INV.couple.name1} & ${INV.couple.name2}`);
  const location = encodeURIComponent(`St. Anthony the Great Church â€” Zahraa El Maadi / La Novia wedding venue`);
  return `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${text}&dates=${fmt(start)}/${fmt(end)}&details=${details}&location=${location}`;
}

function readGuestFromURL(){
  if(!INV.guestPersonalization) return null;
  const url = new URL(window.location.href);
  const g = url.searchParams.get("g");
  return g ? g.trim() : null;
}

let current = 0;

function setSlide(i){
  const track = $("track");
  const n = track.children.length;
  current = Math.max(0, Math.min(i, n-1));
  track.style.transform = `translateX(-${current * 100}%)`;
  [...$("dots").children].forEach((d,idx)=>d.classList.toggle("active", idx===current));
  try{ localStorage.setItem("inv_page", String(current)); }catch(e){}
}

function buildDots(){
  const n = $("track").children.length;
  const dots = $("dots");
  dots.innerHTML = "";
  for(let i=0;i<n;i++){
    const d = document.createElement("div");
    d.className = "dot" + (i===0 ? " active":"");
    d.addEventListener("click", ()=>setSlide(i));
    dots.appendChild(d);
  }
}

function fillTimeline(){
  const t = $("timeline");
  t.innerHTML = "";
  INV.timeline.forEach(item=>{
    const row = document.createElement("div");
    row.className = "row";
    row.innerHTML = `
      <div class="time">${item.time}</div>
      <div class="desc">
        <b>${item.title}</b>
        <span>${item.note||""}</span>
      </div>
    `;
    t.appendChild(row);
  });
}

function updateCountdown(){
  const target = new Date(INV.event.dateTimeISO).getTime();
  const now = Date.now();
  let diff = Math.max(0, target - now);

  const days = Math.floor(diff / (24*60*60*1000));
  diff -= days * (24*60*60*1000);
  const hours = Math.floor(diff / (60*60*1000));
  diff -= hours * (60*60*1000);
  const mins = Math.floor(diff / (60*1000));
  diff -= mins * (60*1000);
  const secs = Math.floor(diff / 1000);

  $("dd").textContent = days;
  $("hh").textContent = pad(hours);
  $("mm").textContent = pad(mins);
  $("ss").textContent = pad(secs);
}

/* ===== Music control (mobile-friendly) ===== */
function initMusic(){
  const audio = $("bgm");
  const src = document.getElementById("bgmSrc");
  const btn = $("musicToggle");
  const led = $("musicLed");
  const text = $("musicText");

  if(MUSIC_URL && MUSIC_URL.trim()){
    src.src = MUSIC_URL.trim();
    audio.load();
    btn.style.display = "flex";
  }else{
    // If no music URL, hide the control
    btn.style.display = "none";
    return;
  }

  const setUI = (playing)=>{
    led.classList.toggle("on", playing);
    text.textContent = playing ? "Pause Music" : "Play Music";
  };

  btn.addEventListener("click", async ()=>{
    try{
      if(audio.paused){
        await audio.play(); // requires user gesture (this click)
        setUI(true);
      }else{
        audio.pause();
        setUI(false);
      }
    }catch(e){
      // If browser blocks it for any reason
      setUI(false);
      alert("Your browser blocked autoplay. Tap again to start the music.");
    }
  });

  audio.addEventListener("pause", ()=>setUI(false));
  audio.addEventListener("play", ()=>setUI(true));
  setUI(false);
}

function init(){
  $("todayPill").textContent = new Date().toLocaleDateString("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"});

  const guest = readGuestFromURL();
  $("guestPill").textContent = guest ? `Private Invitation for ${guest}` : "Private Invitation";

  $("miniSeal").textContent = (INV.couple.name1?.[0]||"M").toUpperCase();
  $("names1").textContent = INV.couple.name1;
  $("names2").textContent = INV.couple.name2;
  $("sealInitials").textContent = INV.couple.initials;

  const {dayName, dateStr} = formatDateParts(INV.event.dateTimeISO);
  $("dateText").textContent = dateStr;
  $("dayText").textContent = dayName;

  $("btnAddCalendar").href = buildCalendarLink();

  fillTimeline();
  buildDots();
  updateCountdown();
  setInterval(updateCountdown, 1000);

  try{
    const saved = parseInt(localStorage.getItem("inv_page")||"0",10);
    if(!Number.isNaN(saved)) setSlide(saved);
  }catch(e){}

  // buttons
  $("btnNext1").onclick = ()=>setSlide(1);
  $("btnPrev2").onclick = ()=>setSlide(0);
  $("btnNext2").onclick = ()=>setSlide(2);
  $("btnPrev3").onclick = ()=>setSlide(1);
  $("btnNext3").onclick = ()=>setSlide(3);
  $("btnPrev4").onclick = ()=>setSlide(2);
  $("btnNext4").onclick = ()=>setSlide(4);
  $("btnPrev5").onclick = ()=>setSlide(3);
  $("btnFinish").onclick = ()=>setSlide(0);

  // swipe
  const slider = $("slider");
  let startX=0, startY=0, dragging=false;

  slider.addEventListener("touchstart",(e)=>{
    const t = e.touches[0];
    startX=t.clientX; startY=t.clientY;
    dragging=true;
  }, {passive:true});

  slider.addEventListener("touchend",(e)=>{
    if(!dragging) return;
    dragging=false;
    const t = e.changedTouches[0];
    const dx = t.clientX - startX;
    const dy = t.clientY - startY;
    if(Math.abs(dx) < 40 || Math.abs(dx) < Math.abs(dy)) return;

    // LTR: swipe left -> next
    if(dx < 0) setSlide(current+1);
    else setSlide(current-1);
  }, {passive:true});

  initMusic();
}

init();
</script>
</body>
</html>
